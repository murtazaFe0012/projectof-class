<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/home.css">
    <title>yo
    </title>
</head>

<body>

    <div class="menu-bar">
        <img src="/images/logo.png" alt="Logo">
        <h1>EventHub</h1>
        <div class="button-group">
            <button class="create-event-btn">
                Créer un événement
            </button>
            <button class="profile-btn" id="profile-btn" aria-label="Profil">
                <img src="/image/profile-picture.png" alt="">
            </button>
        </div>
    </div>

    <div class="filter-bar">
        <p class="filter">
            <i class="fas fa-filter"></i> Filtres:
            <button class="filter-btn">Toutes les catégories</button>
            <button class="filter-btn">Tous les prix</button>
            <button class="filter-btn">Trier par date</button>
        </p>

    </div>

    <div class="event-container">

        <% data.forEach(data=> { %>
            <div class="event-card" data-slug="<%= data.slug %>" role="button" tabindex="0">
                <div class="card-header">
                    <img src="/<%= data.image_url %>" alt="<%= data.title %>">
                    <span class="event-category">
                        <%= data.category %>
                    </span>
                </div>

                <div class="event-details">
                    <h3>
                        <%= data.title %>
                    </h3>
                    <p>
                        <%= data.description %>
                    </p>

                    <p>
                        <i class="far fa-calendar-alt"></i>
                        <%= data.date %><br>
                            <i class="fas fa-map-marker-alt"></i>
                            <%= data.location %>
                    </p>

                    <div class="event-footer">
                        <span>
                            <%= data.attendance %>/<%= data.capacity %>
                        </span>
                        <span style="font-weight: bold;">$ <%= data.price %></span>
                    </div>
                </div>
            </div>
            <% }) %>
    </div>

    <script>
        //rediriger vers la page profil
        (function () {
            const profileBtn = document.getElementById('profile-btn');
            if (profileBtn) profileBtn.addEventListener('click', function () {
                window.location.href = '/profil';
            });

            //carte cliquable et accessible au clavier
            document.querySelectorAll('.event-card').forEach(function (card) {
                const slug = card.dataset.slug;
                if (!slug) return;
                card.style.cursor = 'pointer';
                card.addEventListener('click', function () {
                    window.location.href = '/event?slug=' + encodeURIComponent(slug);
                });
                card.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        window.location.href = '/event?slug=' + encodeURIComponent(slug);
                    }
                });
            });
        })();
    </script>

</body>

</html>